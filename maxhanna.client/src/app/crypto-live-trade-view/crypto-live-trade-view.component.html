<div *ngIf="uniqueCurrencyBots.length == 0" class="secondaryFontColor" style="padding:10px; text-align: center;">
    You must start a tradebot to get a live trade view.
</div>
<!-- Sticky pill bar for quick navigation between coins -->
<div class="coinPillBar" *ngIf="uniqueCurrencyBots.length > 0">
    <div class="coinPill" *ngFor="let bot of uniqueCurrencyBots" (click)="scrollToCoin(bot.currency)" [title]="getNominalCoinName(bot.currency)" [class.hiddenWhenCollapsed]="isPillBarCollapsed">
        {{ getNominalCoinName(bot.currency) }}
    </div>
    <button class="coinPillToggle" (click)="togglePillBar()" [attr.aria-expanded]="!isPillBarCollapsed" [title]="isPillBarCollapsed ? 'Show coins' : 'Hide coins'">
        {{ isPillBarCollapsed ? '▸' : '▾' }}
    </button>
</div>
<div *ngFor="let bot of uniqueCurrencyBots; let i = index" class="grouping" [attr.data-coin]="bot.currency">
    <ng-container *ngIf="shouldShowComponent(i, 'graph'); else graphPlaceholder">
        <app-crypto-coin-graph-viewer #coinGraphViewer [inputtedParentRef]="inputtedParentRef"
            [currentSelectedCoin]="getNominalCoinName(bot.currency)" [selectedCurrency]="selectedCurrency"
            [latestCurrencyPriceRespectToCAD]="latestCurrencyPriceRespectToCAD"></app-crypto-coin-graph-viewer>
    </ng-container>
    <ng-template #graphPlaceholder>
        <div class="component-placeholder"></div>
    </ng-template>

    <div *ngFor="let strategyBot of groupedBotsByCurrency(bot.currency); let j = index">
        <div [class]="onMobile() ? 'logsAndTradeHistoryMobile' : 'logsAndTradeHistory'">
            <ng-container *ngIf="shouldShowComponent(i + j, 'logs'); else logsPlaceholder">
                <div class="tradeLogsContainer">
                    <app-crypto-trade-logs #tradeLogs [inputtedParentRef]="inputtedParentRef"
                        [hasKrakenApi]="hasKrakenApi" [defaultCoin]="bot.currency"
                        [defaultStrategy]="strategyBot.strategy"></app-crypto-trade-logs>
                </div>
            </ng-container>
            <ng-template #logsPlaceholder>
                <div class="component-placeholder"></div>
            </ng-template>

            <ng-container *ngIf="shouldShowComponent(i + j, 'history'); else historyPlaceholder">
                <app-crypto-trade-history #tradeHistory 
                    [inputtedParentRef]="inputtedParentRef"
                    [hasKrakenApi]="hasKrakenApi"
                    [selectedCurrency]="selectedCurrency" 
                    [defaultCoin]="bot.currency"
                    [defaultStrategy]="strategyBot.strategy"></app-crypto-trade-history>
            </ng-container>
            <ng-template #historyPlaceholder>
                <div class="component-placeholder"></div>
            </ng-template>
        </div>
    </div>
</div>