<div class="crypto-news">
    <div *ngIf="loading" class="loading">Loading...</div>
    <div class="pills" *ngIf="!loading && (hasNeg || hasCrypto)">
        <button *ngIf="hasNeg" class="pill" [class.active]="filter === 'negative'"
            (click)="setFilter('negative')">Negative ({{ negCount }})</button>
        <button *ngIf="hasCrypto" class="pill" [class.active]="filter === 'crypto'" (click)="setFilter('crypto')">Crypto
            ({{ cryptoCount }})</button>
    </div>
    <div *ngIf="!loading && (!articles || articles.length === 0)" class="empty">No articles found for today.</div>

    <ul *ngIf="!loading && displayedArticles && displayedArticles.length > 0" class="articles">
        <li *ngFor="let a of displayedArticles" class="article">
            <img *ngIf="a.urlToImage" [src]="a.urlToImage" class="thumb" />
            <div class="meta">
                <a (click)="selectArticle(a)" class="cursorPointer">{{ a.title }}</a>
                <div class="flags">
                    <span *ngIf="a.negative" class="neg">Negative</span>
                    <span *ngIf="a.crypto" class="crypto">Crypto</span>
                </div>
                <p class="desc">{{ a.description }}</p>
                <small class="by">{{ a.author }} ‚Ä¢ {{ a.publishedAt | date:'short' }}</small>
            </div>
        </li>
    </ul>

    <!-- Selected article popup -->
    <div *ngIf="selectedArticle" class="articlePopupPanel popupPanel">
        <div class="popupPanelTitle selectedArticleTitle">{{ selectedArticle.title }}</div>
        <div class="selectedArticleContent">
            <div class="articleContent" [innerHTML]="selectedArticle.content"></div>
            <div class="articleContent" [innerHTML]="selectedArticle.description"></div>
            <div class="articleDetails">
                <div class="articleDetailData">
                    <div class="articleAuthor cursorPointerUnderlined" (click)="openSource(selectedArticle.url)">
                        Author(s): {{ getAuthors(selectedArticle) }}</div>
                    <div class="articleSource cursorPointerUnderlined" (click)="openSource(selectedArticle.url)">Source:
                        {{ selectedArticle.source?.name }}</div>
                    <div class="articleDate cursorPointerUnderlined" (click)="openSource(selectedArticle.url)">Published
                        Date: {{ selectedArticle.publishedAt }}</div>
                </div>
                <div class="mainArticleImage"><img class="articleImage" [attr.loading]="'lazy'"
                        [src]="selectedArticle.urlToImage" /></div>
            </div>
        </div>
        <div class="newsArticleActionButtons">
            <button id="closeOverlay" (click)="selectedArticle = undefined">Close</button>
            <button (click)="saveArticle(selectedArticle)">üíæSave</button>
            <button (click)="openSource(selectedArticle.url)">üì∞Read</button>
            <button
                (click)="parentRef?.addFavourite(selectedArticle.url, selectedArticle.urlToImage, selectedArticle.source?.name ?? undefined)"
                title="Add to Favourites" class="cursorPointer">‚ù§Ô∏è</button>
        </div>
        <div class="closeButton" (click)="selectedArticle = undefined"></div>
    </div>
</div>