<div class="sectionName gradientBackground" style="padding: 10px;">Crypto News</div>
<div class="crypto-news">
    <div *ngIf="loading" class="loading">Loading...</div>
    <div class="pills" *ngIf="!loading && (hasNeg || hasCrypto)">
        <button *ngIf="hasNeg" class="pill" [class.active]="filter === 'negative'"
            (click)="setFilter('negative')">Negative ({{ negCount }})</button>
        <button *ngIf="hasCrypto" class="pill" [class.active]="filter === 'crypto'" (click)="setFilter('crypto')">Crypto
            ({{ cryptoCount }})</button>
    </div>
    <div class="listControls">
        <button class="iconBtn" (click)="toggleCollapsed()" title="Toggle" aria-label="Toggle">{{ collapsed ? 'Expand' : 'Collapse' }}</button>
        <button *ngIf="showTopButton" class="iconBtn" (click)="scrollTop()" title="Scroll to top" aria-label="Scroll to top" style="margin-left:8px">‚ñ≤</button>
    </div>
    <div *ngIf="!loading && (!articles || articles.length === 0)" class="empty">No articles found for today.</div>

    <ul #articlesContainer *ngIf="!loading && displayedArticles && displayedArticles.length > 0" [class.collapsed]="collapsed" class="articles">
        <li *ngFor="let a of displayedArticles" class="article">
            <div class="meta-header">
                <img *ngIf="a.urlToImage" [src]="a.urlToImage" class="thumb" />
                <div class="titleBlock">
                    <a (click)="selectArticle(a)" class="cursorPointer title">{{ a.title }}</a>
                    <div class="flags">
                        <span *ngIf="a.negative" class="neg">Negative</span>
                        <span *ngIf="a.crypto" class="crypto">Crypto</span>
                    </div>
                    <small class="by">{{ a.author }} ‚Ä¢ {{ a.publishedAt | date:'short' }}</small>
                </div>
            </div>
            <div class="meta-desc">
                <p class="desc">{{ a.description }}</p>
            </div>
        </li>
    </ul>

    <!-- Selected article popup -->
    <div *ngIf="showPopup && selectedArticle" class="popupPanel">
        <div class="popupPanelTitle selectedArticleTitle">{{ selectedArticle.title }}</div>
        <div class="selectedArticleContent">
            <div class="articleContent" [innerHTML]="selectedArticle.content"></div>
            <div class="articleContent" [innerHTML]="selectedArticle.description"></div>
            <div class="articleDetails">
                <div class="articleDetailData">
                    <a class="articleAuthor cursorPointerUnderlined linkColor" (click)="parentRef?.indexLink(selectedArticle.url); closeArticle()" [href]="selectedArticle.url" target="_blank">
                        Author(s): {{ getAuthors(selectedArticle) }}</a>
                    <a class="articleSource cursorPointerUnderlined linkColor" (click)="parentRef?.indexLink(selectedArticle.url); closeArticle()" [href]="selectedArticle.url" target="_blank">Source:
                        {{ selectedArticle.source?.name }}</a>
                    <a class="articleDate cursorPointerUnderlined linkColor" (click)="parentRef?.indexLink(selectedArticle.url); closeArticle()" [href]="selectedArticle.url" target="_blank">Published
                        Date: {{ selectedArticle.publishedAt }}</a>
                </div>
                <div class="mainArticleImage"><img class="popupArticleImage articleImage" [attr.loading]="'lazy'"
                        [src]="selectedArticle.urlToImage" /></div>
            </div>
        </div>
        <div class="newsArticleActionButtons">
            <button id="closeOverlay" (click)="closeArticle()">Close</button>
            <button (click)="saveArticle(selectedArticle)">üíæSave</button>
            <button (click)="openSource(selectedArticle.url)">üì∞Read</button>
            <button
                (click)="parentRef?.addFavourite(selectedArticle.url, selectedArticle.urlToImage, selectedArticle.source?.name ?? undefined)"
                title="Add to Favourites" class="cursorPointer">‚ù§Ô∏è</button>
        </div>
    </div>
</div>