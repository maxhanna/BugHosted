<div class="mediaSelectorDiv">
  <button class="mediaSelectorButton pointer" (click)="toggleMediaChoices()">
    🧷Attach
    <span style="font-size:xx-small" *ngIf="selectedFiles && selectedFiles.length > 0">({{ selectedFiles.length }})</span>
  </button>
  <ng-container *ngIf="viewMediaChoicesOpen || displaySearch">
    <div id="selectMediaDiv" [ngClass]="{'open': viewMediaChoicesOpen || displaySearch}">

      <div class="mediaSelectorTitle selectFilesTitle">
        <span>
          Select Media Files <span class="xxSmallFont" *ngIf="selectedFiles && selectedFiles.length > 0">({{selectedFiles.length}})</span>
        </span>
        <button id="closeOverlay" class="doneButton pointer" #doneButton (click)="done()" *ngIf="(displaySearch && selectedFiles.length > 0) ? true  : true">{{selectedFiles && selectedFiles.length > 0 ? 'Done' : 'Cancel'}}</button>
      </div>

      <!-- SELECTED MEDIA FILES-->
      <div [class]="selectedFiles && selectedFiles.length > 0 ? 'mediaChoices' : ''" [style.display]="selectedFiles && selectedFiles.length > 0 ? 'block' : 'none'">
        <div *ngIf="viewMediaChoicesOpen">
          <div class="attachmentChoiceContainer" *ngIf="selectedFiles && selectedFiles.length > 0">
            <div *ngFor="let file of selectedFiles">
              <div class="smallContainerForMedia">
                <div>
                  <div><button (click)="removeFile(file)">Remove {{file.fileName}}</button></div>
                </div>
                <app-media-viewer [user]="user"
                                  [inputtedParentRef]="inputtedParentRef"
                                  [currentDirectory]="file.directory"
                                  [file]="file"
                                  [showCommentSection]="false"
                                  [displayExtraInfo]="false"
                                  [displayExpander]="false"
                                  [autoplay]="false">
                </app-media-viewer>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- file searching display -->

      <div *ngIf="displaySearch" class="fileSearchDiv">
        <app-file-search [user]="user"
                         [inputtedParentRef]="inputtedParentRef"
                         [currentDirectory]="currentDirectory"
                         [clearAfterSelectFile]="true"
                         [showPrivatePublicOption]="false"
                         [maxResults]="10"
                         [canChangeDirectory]="true"
                         [displayFileType]="false"
                         [displayFileSize]="false"
                         [displayFileData]="false"
                         [displayFileActions]="false"
                         [displayReactions]="false"
                         [displayComments]="false"
                         (selectFileEvent)="selectFile($event)"
                         (currentDirectoryChangeEvent)="directoryChanged($event)">
        </app-file-search>
      </div>

       
      <!-- SEARCH/UPLOAD buttons -->
      <div class="searchUploadButtonChoiceDiv">
        <button (click)="displaySearch ? closeSearchDiv($event) : displaySearchDiv()" title="Search for files" class="pointer">
          {{displaySearch ? 'Close Search' : ('🔍Search ' + (selectedFiles.length > 0 ? 'More ' : '') + ' Files' )}}
        </button>
        <div *ngIf="!displaySearch">
          <app-file-upload #fileUploadComponent
                           [uploadButtonText]="'Upload Files'"
                           [inputtedParentRef]="inputtedParentRef"
                           [showPrivatePublicOption]="false"
                           [currentDirectory]="currentDirectory"
                           (userUploadFinishedEvent)="uploadFinishedEvent($event)"
                           (userUploadEvent)="uploadEvent($event)"
                           (userCancelEvent)="uploadCancelledEvent($event)"
                           [user]="user">
          </app-file-upload>
        </div>
      </div>
    </div>
  </ng-container>
</div> 
