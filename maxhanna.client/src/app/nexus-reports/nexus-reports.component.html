<div *ngIf="battleReports && battleReports.battleOutcomes && !isLoading">
  <div class="pageControls">
    Total:{{battleReports.totalReports}}
    <span *ngIf="totalPages && totalPages.length > 0 && !isLoading">
      <label for="currentPage">Page:</label>
      <select #currentPage id="currentPage" (change)="onPageChange()">
        <option *ngFor="let page of totalPages" [value]="page">{{ page }}</option>
      </select>
    </span>
    <span *ngIf="totalPages && totalPages.length > 0 && !isLoading">
      <label for="pageSize">Size:</label>
      <select #pageSize id="pageSize" (change)="onPageSizeChange()">
        <option *ngFor="let size of pageSizes" [value]="size">{{ size }}</option>
      </select>
    </span>
    <button (click)="nextPage()" *ngIf="totalPages && totalPages.length > 1 && !isLoading">Next Page</button> 
  </div>
  
  <div *ngIf="!isLoading">
    <div *ngFor="let report of battleReports.battleOutcomes" class="battleReportDiv">
      <div class="reportHeader">
        <button (click)="deleteReport(report)">Delete</button>
        <span class="reportTimestampSpan">{{ report.timestamp | date:'MM/dd/yyyy HH:mm:ss' }}</span>
      </div>
      <div class="reportTitleDiv">
        <strong>Report #{{report.battleId}}</strong>
      </div>
      <div class="reportsCenterDisplay">
        <div><span (click)="openMapEmitter.emit(report.originCoordsX + ',' + report.originCoordsY)" class="invertedHighlights cursorPointer">({{report.originCoordsX}},{{report.originCoordsY}})</span> - <app-user-tag [user]="report.originUser" [displayOnlyName]="true"></app-user-tag></div>
        <div>VS <span (click)="openMapEmitter.emit(report.destinationCoordsX + ',' + report.destinationCoordsY)" class="invertedHighlights cursorPointer">({{report.destinationCoordsX}},{{report.destinationCoordsY}})</span><span *ngIf="report.destinationUser"> - <app-user-tag [user]="report.destinationUser" [displayOnlyName]="true"></app-user-tag></span></div>
        <div class="reportTimestampSpan">üìÄ Stolen: <span [class]="report.defenderGoldStolen && report.defenderGoldStolen > 0 ? 'goldText' : 'greyText'">{{report.defenderGoldStolen ?? 0 | number:'1.2-2' }}</span> / <span [class]="report.defenderGold && report.defenderGold > 0 ? 'goldText' : 'greyText'">{{report.defenderGold ?? 0 | number:'1.2-2' }}</span></div>
      </div>

      <div class="mainInfoSection">
        Units sent:
      </div>
      <div class="unitSummaryDiv">
        <table>
          <thead>
            <tr>
              <th></th>
              <td *ngFor="let unit of getUnitsArray(report.attackingUnits); let i = index">
                <span class="rotated-header unitCell">{{ unit.key }}</span>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th>‚öîÔ∏è:</th>
              <ng-container *ngFor="let unit of getUnitsArray(report.attackingUnits); let i = index">
                <td [class]="'unitCell ' + (unit.value == 0 ? ' greyText' : '')">{{ unit.value }}</td>
              </ng-container>
            </tr>
            <tr>
              <th>üõ°Ô∏è:</th>
              <ng-container *ngFor="let unit of getUnitsArray(report.attackingUnits); let i = index">
                <td [class]="'unitCell ' + (!report.defendingUnits[unit.key] || report.defendingUnits[unit.key] == 0 ? ' greyText' : '')">{{ report.defendingUnits[unit.key] || 0 }}</td>
              </ng-container>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="mainInfoSection">
        Losses:
      </div>
      <div class="unitSummaryDiv">
        <table>
          <thead>
            <tr>
              <th></th>
              <td *ngFor="let unit of getUnitsArray(report.attackingLosses); let i = index">
                <span class="rotated-header unitCell">{{ unit.key }}</span>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th>‚öîÔ∏è:</th>
              <ng-container *ngFor="let unit of getUnitsArray(report.attackingLosses); let i = index">
                <td [class]="'unitCell ' + (unit.value == 0 ? ' greyText' : '')">{{ unit.value }}</td>
              </ng-container>
            </tr>
            <tr>
              <th>üõ°Ô∏è:</th>
              <ng-container *ngFor="let unit of getUnitsArray(report.defendingLosses); let i = index">
                <td [class]="'unitCell ' + (report.defendingLosses[unit.key] == 0 ? ' greyText' : '')">{{ report.defendingLosses[unit.key] || 0 }}</td>
              </ng-container>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="mainInfoSection">
        Defender Buildings:
      </div>
      <div class="unitSummaryDiv" *ngIf="report.defenderBuildingLevels">
        <table>
          <thead>
            <tr>
              <th></th>
              <td *ngFor="let unit of getUnitsArray(report.defenderBuildingLevels); let i = index">
                <span class="rotated-header unitCell">{{ unit.key }}</span>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th>üè∞:</th>
              <ng-container *ngFor="let unit of getUnitsArray(report.defenderBuildingLevels); let i = index">
                <td [class]="'unitCell ' + (unit.value == 0 ? ' greyText' : '')">{{ unit.value }}</td>
              </ng-container>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="mainInfoSection">
        Defender units not in village:
      </div>
      <div class="unitSummaryDiv" *ngIf="report.defenderUnitsNotInVillage">
        <table>
          <thead>
            <tr>
              <th></th>
              <td *ngFor="let unit of getUnitsArray(report.defenderUnitsNotInVillage); let i = index">
                <span class="rotated-header unitCell">{{ unit.key }}</span>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th>üõ°Ô∏è:</th>
              <ng-container *ngFor="let unit of getUnitsArray(report.defenderUnitsNotInVillage); let i = index">
                <td [class]="'unitCell ' + (unit.value == 0 ? ' greyText' : '')">{{ unit.value }}</td>
              </ng-container>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<div *ngIf="isLoading || !battleReports || !battleReports.battleOutcomes || battleReports.battleOutcomes.length == 0">
  {{isLoading ? 'Loading reports...' : ''}}
</div>
<div *ngIf="battleReports && !battleReports.totalReports" class="notification">
  This is where battle reports will show up after you attack or get attacked.
</div>
